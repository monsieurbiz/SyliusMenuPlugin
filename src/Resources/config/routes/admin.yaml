monsieurbiz_menu_admin_menu:
    resource: |
        alias: monsieurbiz_menu.menu
        section: admin
        permission: true
        templates: "@SyliusAdmin\\shared\\crud"
        except: ['show', 'bulkDelete']
        redirect: index
        grid: monsieurbiz_menu_menu
        vars:
            index:
                icon: 'sitemap'
    type: sylius.resource

monsieurbiz_menu_admin_menu_item_create_for_menu:
    path: /menus/{menuId}/new-item
    methods: [GET, POST]
    defaults:
        _controller: monsieurbiz_menu.controller.menu_item::createAction
        _sylius:
            section: admin
            permission: true
            template: '@SyliusAdmin/shared/crud/create.html.twig'
            redirect: &sylius_redirect
                route: monsieurbiz_menu_admin_menu_update
                parameters:
                    id: 'expr:$menuId'
            factory:
                method: createForMenu
                arguments: ['expr:notFoundOnNull(service("monsieurbiz_menu.repository.menu").find($menuId))']
            vars:
                route:
                    name: 'monsieurbiz_menu_admin_menu_item_create_for_menu'
                    parameters:
                        menuId: 'expr:$menuId'
                index: &sylius_vars_index
                    route:
                        name: 'monsieurbiz_menu_admin_menu_update'
                        parameters:
                            id: 'expr:$menuId'
                templates: &sylius_vars_templates
                    form: '@MonsieurBizSyliusMenuPlugin/Admin/MenuItem/_form.html.twig'

monsieurbiz_menu_admin_menu_item_create_for_parent:
    path: /menus/{menuId}/item/{parentId}/new-item
    methods: [GET, POST]
    defaults:
        _controller: monsieurbiz_menu.controller.menu_item::createAction
        _sylius:
            section: admin
            permission: true
            template: '@SyliusAdmin/shared/crud/create.html.twig'
            redirect: *sylius_redirect
            factory:
                method: createForParent
                arguments: ['expr:notFoundOnNull(service("monsieurbiz_menu.repository.menu_item").find($parentId))']
            vars:
                route:
                    name: 'monsieurbiz_menu_admin_menu_item_create_for_parent'
                    parameters:
                        menuId: 'expr:$menuId'
                        parentId: 'expr:$parentId'
                index: *sylius_vars_index
                templates: *sylius_vars_templates

monsieurbiz_menu_admin_menu_item_update:
    path: /menus/{menuId}/update-item/{id}
    methods: [GET, PUT, POST]
    defaults:
        _controller: monsieurbiz_menu.controller.menu_item::updateAction
        _sylius:
            section: admin
            permission: true
            template: '@SyliusAdmin/shared/crud/update.html.twig'
            redirect: *sylius_redirect
            vars:
                route:
                    name: 'monsieurbiz_menu_admin_menu_item_update'
                    parameters:
                        menuId: 'expr:$menuId'
                        id: 'expr:$id'
                index: &sylius_vars_index
                    route:
                        name: 'monsieurbiz_menu_admin_menu_index'
                templates: *sylius_vars_templates

monsieurbiz_menu_admin_browser_list:
    path: /ajax/menus-browser/list
    methods: [GET]
    defaults:
        _controller: 'MonsieurBiz\SyliusMenuPlugin\Controller\BrowserController::listAction'
    condition: 'request.headers.get("X-Requested-With") == "XMLHttpRequest"'


monsieurbiz_menu_admin_browser_list_items:
    path: /ajax/menus-browser/list-items
    methods: [GET]
    defaults:
        _controller: 'MonsieurBiz\SyliusMenuPlugin\Controller\BrowserController::listItemsAction'
    condition: 'request.headers.get("X-Requested-With") == "XMLHttpRequest"'
